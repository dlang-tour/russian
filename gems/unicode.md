# Unicode –≤ D

Unicode - –æ–±—â–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
–≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö. D –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Unicode –∫–∞–∫ –Ω–∞
—É—Ä–æ–≤–Ω–µ —è–∑—ã–∫–∞, —Ç–∞–∫ –∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.

## –ß—Ç–æ –∏ –ø–æ—á–µ–º—É

–ö–æ–º–ø—å—é—Ç–µ—Ä—ã, –Ω–∞ —Å–∞–º–æ–º –Ω–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ, –Ω–µ –∏–º–µ—é—Ç –ø–æ–Ω—è—Ç–∏—è –æ —Ç–æ–º,
—á—Ç–æ —Ç–∞–∫–æ–µ —Ç–µ–∫—Å—Ç, –ø–æ—Å–∫–æ–ª—å–∫—É —Ä–∞–±–æ—Ç–∞—é—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —Å —á–∏—Å–ª–∞–º–∏.
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —ç—Ç–æ–≥–æ, –Ω–µ–æ–±—Ö–æ–¥–∏–º –∫–æ–¥ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
—Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –¥–≤–æ–∏—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ. –ú–µ—Ç–æ–¥ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
–Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è *–∫–æ–¥–∏—Ä–æ–≤–∫–æ–π*, –∏ Unicode —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ —Ç–∞–∫–æ–≤—ã—Ö
–º–µ—Ç–æ–¥–æ–≤.

–ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —á–∏—Å–ª–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ,
–ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–¥.

Unicode —É–Ω–∏–∫–∞–ª–µ–Ω —Ç–µ–º, —á—Ç–æ –µ–≥–æ –¥–∏–∑–∞–π–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å
–≤—Å–µ —è–∑—ã–∫–∏ –º–∏—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É—è –æ–¥–Ω—É –∏ —Ç—É –∂–µ –∫–æ–¥–∏—Ä–æ–≤–∫—É. –î–æ –ø–æ—è–≤–ª–µ–Ω–∏—è
Unicode, –∫–æ–º–ø—å—é—Ç–µ—Ä—ã, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–Ω—ã–º–∏ –∫–æ–º–ø–∞–Ω–∏—è–º–∏, –∏–ª–∏ –ø–æ—Å—Ç–∞–≤–ª—è–≤—à–∏–µ—Å—è
–Ω–∞ —Ä–∞–∑–Ω—ã–µ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –Ω–µ–ª—å–∑—è –±—ã–ª–æ —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Å–≤—è–∑–∏, –∞ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö
—Å–ª—É—á–∞—è—Ö –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –∏ –≤–æ–≤—Å–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª–∞—Å—å, —á—Ç–æ –¥–µ–ª–∞–ª–æ –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—Å—Ç–∞
–Ω–∞ —Ç–∞–∫–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã–º.

–î–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è Unicode –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç–æ–Ω–∫–æ—Å—Ç–µ–π,
–æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å–æ —Å—Ç–∞—Ç—å—ë–π –æ Unicode –≤ –í–∏–∫–∏–ø–µ–¥–∏–∏ (—Å—Å—ã–ª–∫–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ
"–í –¥–µ—Ç–∞–ª—è—Ö").

## –ö–∞–∫

Unicode –∏—Å–ø—Ä–∞–≤–∏–ª –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º, –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
–ª—é–±–æ–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–∞—à–∏–Ω–æ–π. D —É—á–∏—Ç—Å—è –Ω–∞ –æ—à–∏–±–∫–∞—Ö –ø—Ä–æ—à–ª—ã—Ö —è–∑—ã–∫–æ–≤,
–∏ **–≤—Å–µ** —Å—Ç—Ä–æ–∫–∏ –≤ D - —Å—Ç—Ä–æ–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Unicode, —Ç–æ–≥–¥–∞ –∫–∞–∫
—Å—Ç—Ä–æ–∫–∏ –≤ —Ç–∞–∫–∏—Ö —è–∑—ã–∫–∞—Ö, –∫–∞–∫ C –∏ C++ - –ª–∏—à—å –º–∞—Å—Å–∏–≤—ã –±–∞–π—Ç–æ–≤.

–í D `string`, `wstring`, –∏ `dstring` - —ç—Ç–æ —Å—Ç—Ä–æ–∫–∏, –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
–≤ UTF-8, UTF-16 –∏ UTF-32 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –¢–∏–ø—ã —Å–∏–º–≤–æ–ª–æ–≤ –≤ –Ω–∏—Ö -
`char`, `wchar`, –∏ `dchar`.

–°–æ–≥–ª–∞—Å–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ-Unicode –¥–∞–Ω–Ω—ã—Ö –≤ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö
—Ç–∏–ø–∞—Ö D —è–≤–ª—è–µ—Ç—Å—è –æ—à–∏–±–∫–æ–π; –æ–∂–∏–¥–∞–π—Ç–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ—Ç–∫–∞–∑–æ–≤ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ,
–µ—Å–ª–∏ –≤–∞—à–∏ —Å—Ç—Ä–æ–∫–∏ –Ω–µ–≤–µ—Ä–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã.

–î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∫ –≤ –¥—Ä—É–≥–∏—Ö –∫–æ–¥–∏—Ä–æ–≤–∫–∞—Ö, –∏–ª–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è,
–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–≥–æ C/C++, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `ubyte[]` –∏–ª–∏ `char*`.

## –°—Ç—Ä–æ–∫–∏ –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö –Ω–∞–¥ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏

*–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø—Ä–æ—á–µ—Å—Ç—å [–∂–µ–º—á—É–∂–∏–Ω—É –æ–± –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö –Ω–∞–¥ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏](gems/range-algorithms)
–ø–µ—Ä–µ–¥ –ø—Ä–æ—á—Ç–µ–Ω–∏–µ–º –¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞.*

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–º–µ—Ç—å –≤ –≤–∏–¥—É —Ä—è–¥ –ø–æ–¥–≤–æ–¥–Ω—ã—Ö –∫–∞–º–Ω–µ–π –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Unicode –≤ D.

–í–æ-–ø–µ—Ä–≤—ã—Ö, –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞, –ø—Ä–∏ –∏—Ç–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—Ç—Ä–æ–∫ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
—Ñ—É–Ω–∫—Ü–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤, Phobos –∫–æ–¥–∏—Ä—É–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã `string` –∏ `wstring`
–≤ –∫–æ–¥–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏ UTF-32. –≠—Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞, –∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞–∫
**–∞–≤—Ç–æ-–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ**, –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ

```
static assert(is(typeof(utf8.front) == dchar));
```

–¢–∞–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤–ª–µ—á—ë—Ç —Ä—è–¥ –Ω–µ—è–≤–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π, –≥–ª–∞–≤–Ω–æ–µ –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö,
–ø—É—Ç–∞—é—â–µ–µ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ª—é–¥–µ–π, —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ
`std.traits.hasLength!(string)` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `False`.
–ü–æ—á–µ–º—É? –ü–æ—Ç–æ–º—É, —á—Ç–æ –≤ —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏–∏ API –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤, –º–µ—Ç–æ–¥
`length` —Ç–∏–ø–∞ `string` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Å—Ç—Ä–æ–∫–µ**,
–∞ –Ω–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ *–¥–∏–∞–ø–∞–∑–æ–Ω–µ, —Å –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—è*.

–ù–∞ –ø—Ä–∏–º–µ—Ä–µ —è–≤–Ω–æ –≤–∏–¥–Ω–æ, –ø–æ—á–µ–º—É —ç—Ç–∏ –¥–≤–µ "–¥–ª–∏–Ω—ã" –Ω–µ –≤—Å–µ–≥–¥–∞ —Ä–∞–≤–Ω—ã.
–ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—ã –Ω–∞–¥ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏ –≤ Phobos —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–∞–∫,
–±—É–¥—Ç–æ `string` –Ω–µ –∏–º–µ–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–ª–∏–Ω–µ.

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∞–≤—Ç–æ-–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–∏,
–∏ –æ —Ç–æ–º, —á—Ç–æ –æ–Ω–æ –æ–∑–Ω–∞—á–∞–µ—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –≤–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å
—Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ –ø–æ —Å—Å—ã–ª–∫–∞–º –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–í –¥–µ—Ç–∞–ª—è—Ö".

### –ü–æ–¥—Ä–æ–±–Ω–µ–µ

- [–°—Ç—Ä–∞–Ω–∏—Ü–∞ –í–∏–∫–∏–ø–µ–¥–∏–∏ –æ Unicode](https://ru.wikipedia.org/wiki/Unicode)
- [Basic Unicode Functions in Phobos](https://dlang.org/phobos/std_uni.html)
- [Tools for Decoding and Encoding UTF in Phobos](https://dlang.org/phobos/std_utf.html)
- [An in Depth Look at Auto Decoding](https://jackstouffer.com/blog/d_auto_decoding_and_you.html)
- [An in Depth Essay on Benefits of Using UTF-8](http://utf8everywhere.org/)

## {SourceCode}

```d
import std.range.primitives : empty,
    front, popFront;
import std.stdio : write, writeln;

void main()
{
    string utf8 = "√• √∏ ‚àë üò¶";
    wstring utf16 = "√• √∏ ‚àë üò¶";
    dstring utf32 = "√• √∏ ‚àë üò¶";

    writeln("utf8 length: ", utf8.length);
    writeln("utf16 length: ", utf16.length);
    writeln("utf32 length: ", utf32.length);

    foreach (item; utf8)
    {
        auto c = cast(ubyte) item;
        write(c, " ");
    }
    writeln();

    // –ü–æ—Å–∫–æ–ª—å–∫—É —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ç–∏–ø —ç–ª–µ–º–µ–Ω—Ç–∞ -
    // dchar, –±—É–¥–µ–º –∑–∞–≥–ª—è–¥—ã–≤–∞—Ç—å –≤–ø–µ—Ä—ë–¥, —á—Ç–æ–±—ã
    // –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –≤–∏–¥–µ –∫–æ–¥–æ–≤—ã—Ö
    // –ø–æ–∑–∏—Ü–∏–π UTF-32.
    // –î–ª—è –Ω–µ—Å—Ç—Ä–æ–∫–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
    // –ø—Ä–æ—Å—Ç–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
    foreach (dchar item; utf16)
    {
        auto c = cast(ushort) item;
        write(c, " ");
    }
    writeln();

    // —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–≤—Ç–æ–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
    static assert(
        is(typeof(utf8[0]) == immutable(char))
    );
    static assert(
        is(typeof(utf8.front) == dchar)
    );
}
```
